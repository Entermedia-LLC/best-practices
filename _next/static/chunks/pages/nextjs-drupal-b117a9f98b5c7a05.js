(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{3940:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nextjs-drupal",function(){return n(3802)}])},3802:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return u}});var r=n(5893),t=n(7294),o=n(9008),l=n(1664),a=n(323),i=n(2430),c=n(6768),d=n.n(c),p=n(4725),h=n.n(p);n(1804),n(9980),n(4277),n(2963);function u(){return(0,t.useEffect)((function(){h().highlightAll()}),[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.default,{children:(0,r.jsx)("title",{children:"Next.js for Drupal | Entermedia Best Practices"})}),(0,r.jsxs)(a.Z,{children:[(0,r.jsx)(i.Z,{level:1,children:"Next.js for Drupal"}),(0,r.jsxs)("p",{children:["The purpose of this document is to help guide you through working with a potential project using the framework,"," ",(0,r.jsx)("a",{href:"https://next-drupal.org/",target:"_blank",rel:"noreferrer noopener",children:"Next.js for Drupal"}),". Outside of the official documentation, you should find here personalized recommendations for using the framework based on the types of projects we typically see at Entermedia. We have broken these recommendations out into common elements we tend to interact with often in client work. If something you\u2019re looking for isn\u2019t represented you can either submit a pull request to this repository or refer to the official"," ",(0,r.jsx)("a",{href:"https://next-drupal.org/docs",target:"_blank",rel:"noopener noreferrer",children:"Next.js for Drupal"})," ","documentation."]}),(0,r.jsx)(i.Z,{level:2,id:"aria-project-setup",showAnchor:!0,children:"Project Setup"}),(0,r.jsx)("p",{children:"Entermedia follows a standardized approach for setting up new Next.js for Drupal projects. This allows developers to easily switch between projects, faster project initialization, and ramp-up for new developers. All of these types of projects should start with this same setup."}),(0,r.jsx)("p",{children:(0,r.jsxs)("strong",{children:["To begin, follow the instructions for"," ",(0,r.jsx)("a",{href:"https://next-drupal.org/docs/quick-start#1-create-site",target:"_blank",rel:"noreferrer noopener",children:"creating a Next.js site"})," ","in Next.js for Drupal's docs."]})}),(0,r.jsx)(i.Z,{level:3,children:"Install commitlint"}),(0,r.jsxs)("p",{children:["For projects using Git,"," ",(0,r.jsx)(l.default,{href:"/tools#aria-commitlint-install",children:"install commitlint"}),"."]}),(0,r.jsx)(i.Z,{level:3,children:"Install Sass"}),(0,r.jsxs)("p",{children:["Entermedia uses"," ",(0,r.jsx)("a",{href:"https://sass-lang.com/",target:"_blank",rel:"noreferrer noopener",children:"Sass"})," ","to compile CSS. Next.js allows you to import Sass using both the"," ",(0,r.jsx)("code",{children:".scss"})," extension. You can use component-level Sass via CSS Modules and the ",(0,r.jsx)("code",{children:".module.scss"})," extension."]}),(0,r.jsxs)("p",{children:["Before you can use Next.js' built-in Sass support, be sure to install"," ",(0,r.jsx)("a",{href:"https://github.com/sass/sass",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)("code",{children:"sass"})}),". Follow the instructions found in"," ",(0,r.jsx)("a",{href:"https://nextjs.org/docs/basic-features/built-in-css-support#sass-support",target:"_blank",rel:"noreferrer noopener",children:"Next.js' documentation"}),"."]}),(0,r.jsx)(i.Z,{level:4,children:"Enable Sass in styled-jsx"}),(0,r.jsxs)("p",{children:["Next.js has sass support is built-in, but this doesn't extend to the styling inside styled-jsx tags. To extend this, you'll need to install"," ",(0,r.jsx)("a",{href:"https://www.npmjs.com/package/@styled-jsx/plugin-sass",target:"_blank",rel:"noreferrer noopener",children:"@styled-jsx/plugin-sass"})," ","and"," ",(0,r.jsx)("a",{href:"https://www.npmjs.com/package/sass",target:"_blank",rel:"noreferrer noopener",children:"dart-sass"})," ","dependencies:"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"yarn install --save-dev @styled-jsx/plugin-sass sass"})}),"Then create a ",(0,r.jsx)("code",{children:".babelrc.json"})," file in the project folder with:",(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-json",children:'{\n  "presets": [\n    [\n      "next/babel",\n      {\n        "styled-jsx": {\n          "plugins": ["@styled-jsx/plugin-sass"]\n        }\n      }\n    ]\n  ]\n}'})}),(0,r.jsx)(i.Z,{level:3,children:"Install Normalize.css"}),(0,r.jsxs)("p",{children:["It's important that projects have the same starting point for browsers when rendering elements. Entermedia uses"," ",(0,r.jsx)("a",{href:"https://necolas.github.io/normalize.css/",target:"_blank",rel:"noreferrer noopener",children:"Normalize.css"})," ","to do this to make elements render more consistently and in line with modern standards."]}),(0,r.jsx)(i.Z,{level:3,children:"Install Storybook"}),(0,r.jsxs)("p",{children:["Entermedia uses"," ",(0,r.jsx)("a",{href:"",target:"_blank",rel:"noreferrer noopener",children:"Storybook"})," ","for building UI components and pages in isolation, allowing for streamline UI development, testing, and documentation."]}),(0,r.jsxs)("p",{children:["Follow"," ",(0,r.jsx)("a",{href:"https://storybook.js.org/blog/get-started-with-storybook-and-next-js/",target:"_blank",rel:"noopener noreferrer",children:"these instructions"})," ","to get Storybook up and running in the Next.js project."]}),(0,r.jsxs)("p",{children:["Once Storybook is installed, add the"," ",(0,r.jsx)("a",{href:"https://storybook.js.org/addons/storybook-addon-next#csssassscss-modules",target:"_blank",rel:"noopener noreferrer",children:"Next.js addon"}),"."]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Having a problem running Storybook?"})," There's are a few known issues when running ",(0,r.jsx)("code",{children:"yarn storybook"}),":"]}),(0,r.jsx)("p",{className:d()["error-title"],children:"Error:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"Error: Cannot find module 'webpack/lib/util/makeSerializable.js'"})}),(0,r.jsx)("p",{className:d()["fix-title"],children:"Fix:"}),(0,r.jsx)("p",{className:d()["no-margin"],children:"If you run into this, you'll need to install webpack 5 as a dev dependency:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"npm install webpack@5.68.0 --save-dev"})}),(0,r.jsx)("p",{className:d()["error-title"],children:"Error:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"ModuleNotFoundError: Module not found: Error: Can't resolve '@storybook/addon-docs'..."})}),(0,r.jsx)("p",{className:d()["fix-title"],children:"Fix:"}),(0,r.jsx)("p",{className:d()["no-margin"],children:"If you run into this, you'll need to install the @storybook/addon-docs package as a dev dependency:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"npm install @storybook/addon-docs --save-dev"})}),(0,r.jsx)("p",{className:d()["error-title"],children:"Error:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:"ModuleNotFoundError: Module not found: Error: Can't resolve 'style-loader'..."})}),(0,r.jsx)("p",{className:d()["fix-title"],children:"Fix:"}),(0,r.jsxs)("p",{className:d()["no-margin"],children:["To fix, esnure the ",(0,r.jsx)("code",{children:"storybook-addon-next"})," module is installed as a ",(0,r.jsx)("code",{children:"devDependencies"}),":"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:'"devDependencies": {\n    "storybook-addon-next": "^1.4.4",\n  }'})}),(0,r.jsx)("p",{className:d()["error-title"],children:"Error:"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-sh",children:'Though the "loose" option was set to "false" in your @babel/preset-env config...'})}),(0,r.jsx)("p",{className:d()["fix-title"],children:"Fix:"}),(0,r.jsxs)("p",{className:d()["no-margin"],children:["Update the ",(0,r.jsx)("code",{children:".babelrc.json"})," config with the following:"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-json",children:'"plugins": [\n    ["@babel/plugin-proposal-private-property-in-object", { "loose": true }]\n  ]'})}),(0,r.jsx)(i.Z,{level:4,children:"Update Storybook Config & Remove Example Stories"}),(0,r.jsxs)("p",{children:["Once Storybook has been installed, update the"," ",(0,r.jsx)("code",{children:".storybook/main.js"})," config to look for stories in the components directory:"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-json",children:'stories: [\n    "../stories/**/*.stories.mdx",\n    "../stories/**/*.stories.@(js|jsx|ts|tsx)",\n    "../components/**/*.stories.mdx",\n    "../components/**/*.stories.@(js|jsx|ts|tsx)",\n  ],'})}),(0,r.jsxs)("p",{children:["Include the global styles & set the default sorting order in Storybook's ",(0,r.jsx)("code",{children:"preview.js"})," config:"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-javascript",children:'// Import global styles\nimport "normalize.css";\nimport "../styles/theme/default.scss";\nimport "../styles/base.scss";'})}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-javascript",children:'export const parameters = {\n  options: {\n    storySort: {\n      order: [\n        "Design System",\n        [\n          "Atoms",\n          "Molecules",\n          "Organisms",\n          ["Header", "Footer"],\n          "Templates",\n          "Pages",\n          "SVGs",\n        ],\n      ],\n    },\n  },\n};'})}),(0,r.jsx)(i.Z,{level:4,children:"Useful Storybook Links"}),(0,r.jsx)("ul",{children:(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"https://www.youtube.com/watch?v=i5tvZ9f7gJw",target:"_blank",rel:"noopener noreferrer",children:"5 Tips for Integrating Next.js with Storybook"})})}),(0,r.jsx)(i.Z,{level:3,children:"Install Leasoft"}),(0,r.jsxs)("p",{children:["Entermedia uses"," ",(0,r.jsx)("a",{href:"https://github.com/pgilad/leasot",target:"_blank",rel:"noreferrer noopener",children:"Leasot"})," ","to intelligently parse and output TODOs and FIXMEs from comments in your files. Once installed, add a new npm command in the package.json file:"]}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-json",children:"\"todo\": \"leasot 'components/**/*.tsx' 'pages/**/*.tsx' 'components/**/*.scss' 'styles/**/*.scss' 'lib/**/*/ts'\""})}),(0,r.jsx)(i.Z,{level:3,children:"Project Structure"}),(0,r.jsx)("p",{children:"Next.js for Drupal's default project setup will need to be initially cleaned up to follow Entermedia's perferred project structure and to remove unused dependencies."}),(0,r.jsx)("ul",{children:(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"/styles"})," - See the"," ",(0,r.jsx)(l.default,{href:"/js/nextjs#project-structure",children:"styles structure for Next.js projects"})]})}),(0,r.jsx)(i.Z,{level:3,children:"File Updates"}),(0,r.jsx)("p",{children:"Once the project has been updated to follow the structure above and needed dependencies installed, some of the starter files will need to be updated."}),(0,r.jsx)("ul",{children:(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"/pages/_app.tsx"}),(0,r.jsx)("pre",{children:(0,r.jsx)("code",{className:"language-javascript",children:'// Import Next dependencies\nimport { AppProps } from "next/app";\n\n// Import component dependencies\nimport { DefaultTemplate } from "@/components/templates/DefaultTemplate/DefaultTemplate";\n\n// Import global styles\nimport "normalize.css";\nimport "../styles/theme/default.scss";\nimport "../styles/base.scss";\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return (\n    <DefaultTemplate>\n      <Component {...pageProps} />\n    </DefaultTemplate>\n  );\n}\n'})})]})})]})]})}},6768:function(e){e.exports={"error-title":"typography_error-title__mK4uz","fix-title":"typography_fix-title__qTm4O","no-margin":"typography_no-margin__Alq85"}},4277:function(){Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}},Prism.languages.webmanifest=Prism.languages.json},2963:function(){!function(e){var s=[/"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/.source,/'[^']*'/.source,/\$'(?:[^'\\]|\\[\s\S])*'/.source,/<<-?\s*(["']?)(\w+)\1\s[\s\S]*?[\r\n]\2/.source].join("|");e.languages["shell-session"]={command:{pattern:RegExp(/^/.source+"(?:"+/[^\s@:$#%*!/\\]+@[^\r\n@:$#%*!/\\]+(?::[^\0-\x1F$#%*?"<>:;|]+)?/.source+"|"+/[/~.][^\0-\x1F$#%*?"<>@:;|]*/.source+")?"+/[$#%](?=\s)/.source+/(?:[^\\\r\n \t'"<$]|[ \t](?:(?!#)|#.*$)|\\(?:[^\r]|\r\n?)|\$(?!')|<(?!<)|<<str>>)+/.source.replace(/<<str>>/g,(function(){return s})),"m"),greedy:!0,inside:{info:{pattern:/^[^#$%]+/,alias:"punctuation",inside:{user:/^[^\s@:$#%*!/\\]+@[^\r\n@:$#%*!/\\]+/,punctuation:/:/,path:/[\s\S]+/}},bash:{pattern:/(^[$#%]\s*)\S[\s\S]*/,lookbehind:!0,alias:"language-bash",inside:e.languages.bash},"shell-symbol":{pattern:/^[$#%]/,alias:"important"}}},output:/.(?:.*(?:[\r\n]|.$))*/},e.languages["sh-session"]=e.languages.shellsession=e.languages["shell-session"]}(Prism)}},function(e){e.O(0,[247,521,737,774,888,179],(function(){return s=3940,e(e.s=s);var s}));var s=e.O();_N_E=s}]);